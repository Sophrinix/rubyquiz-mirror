<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<!-- Start Wayback Rewrite JS Include -->
<script type="text/javascript" src="/static/js/jwplayer/jwplayer.js" ></script>
<script type="text/javascript" src="/static/js/video-embed-rewriter.js"></script>
<script type="text/javascript">
function initYTVideo(id)
{
	_wmVideos_.init("/web/", id);
}
</script>
<!-- End Wayback Rewrite JS Include -->

	<title>Ruby Quiz - Learning Tic-Tac-Toe (#11)</title>
	<link rel="stylesheet" type="text/css" href="/web/20120121213151cs_/http://rubyquiz.com/quiz.css" />
	<link rel="stylesheet" type="text/css" href="/web/20120121213151cs_/http://rubyquiz.com/print.css" media="print" />
</head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/rubyquiz.com\/quiz11.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Jan";
var displayYear = "2012";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://rubyquiz.com/quiz11.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20120121213151" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20110831031425/http://www.rubyquiz.com/quiz11.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="31 Aug 2011"><strong>AUG</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 21:31:51 Jan 21, 2012">JAN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20120418122543/http://www.rubyquiz.com/quiz11.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2012"><strong>APR</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20110831031425/http://www.rubyquiz.com/quiz11.html" title="3:14:25 Aug 31, 2011" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 21:31:51 Jan 21, 2012">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120122025336/http://rubyquiz.com/quiz11.html" title="2:53:36 Jan 22, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127172012/http://rubyquiz.com/quiz11.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 21:31:51 Jan 21, 2012">2012</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20130215052425/http://rubyquiz.com/quiz11.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Feb 2013"><strong>2013</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20120121213151*/http://rubyquiz.com/quiz11.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>36 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">21 Apr 06 - 15 Feb 13</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000210000100_2007:-1:000100200000_2008:-1:000010000000_2009:-1:000000000000_2010:-1:000000000010_2011:-1:000001120000_2012:0:30017000a100_2013:-1:010000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	<div id="page">
		<div id="header"><span class="ruby">Ruby</span> <span class="quiz">Quiz</span></div>
		<div id="content">
			<span class="title">Learning Tic-Tac-Toe (#11)</span>
			<p>This week's Ruby Quiz is to implement an AI for playing Tic-Tac-Toe, with a catch:  You're not allowed to embed any knowledge of the game into your creation beyond how to make legal moves and recognizing that it has won or lost.</p>
			<p>Your program is expected to "learn" from the games it plays, until it masters the game and can play flawlessly.</p>
			<p>Submissions can have any interface, but should be able to play against humans interactively.  However, I also suggest making it easy to play against another AI, so you can "teach" the program faster.</p>
			<p>Being able to monitor the learning progression and know when a program has mastered the game would be very interesting, if you can manage it.</p>
			<hr />
			<p><span class="title">Quiz Summary</span></p>
			<p>In an interesting contrast, this quiz generated a lot of good discussion, but only two solutions.  I believe that may be because the problem turned out to be more complicated than I intended.  I know I personally ran into a few complications and didn't have a chance to finish my own solution.</p>
			<p>Again, the discussion was excellent and you should probably skim the thread, if you weren't following it this weekend.  Multiple Tic-Tac-Toe servers (written in Ruby, of course) were posted, so programs could play against each other remotely.</p>
			<p>I posted a message about how Tic-Tac-Toe positions can be transformed by rotation and "mirroring" to other seemly different layouts that can be handled the same.</p>
			<p>I also posted a "tictactoe.rb" library that makes most interaction with the game trivially simple.  </p>
			<p>Finally, a few of us posted some notes about the problems we ran into.  I agree with Hans Fugal, who said that you can learn almost as much from those.</p>
			<p>The two solutions posted are similar.  Basically, they learn to avoid their mistakes over time.  They accomplish this by "scoring" the moves they made at each position in a game, based on whether they won or lost.  Eventually, this knowledge allows them to select mainly strong moves, simply by remembering how they've done in the past, in the same position.</p>
			<p>I'll show Brian Schr&ouml;der's code here, but both were interesting to examine.  Brian's solution contained eight files of Ruby code, the embedded documentation for said files, charts, a write-up of the process, and was all wrapped up in a handy web page, so you can dig as deep as you like into what he's done.  (And he once asked where <b>I</b> find the time!)  For the purposes of this summary, I'll stick to his learning code.</p>
			<p>Here it is:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> Learning &lt; BasicInterface<br />      attr_accessor :random_prob<br />      attr_reader :player<br /><br />      <span class="keyword">def</span> initialize<br />        <span class="variable">@state_values</span> = Hash.new(0)<br />        <span class="variable">@state_transitions</span> = {}<br />        <span class="variable">@random_prob</span> = 0.05<br />      <span class="keyword">end</span><br /><br />      <span class="keyword">def</span> new_game(player)<br />        <span class="variable">@player</span> = player<br />        <span class="variable">@states_visited</span> = []<br />      <span class="keyword">end</span><br /><br />      <span class="keyword">def</span> choose_move(game)<br />        moves = game.moves<br />        <span class="keyword">if</span> !<span class="variable">@state_transitions</span>[game.state_id] <span class="keyword">or</span> rand &lt; random_prob<br />          move = moves[rand(moves.length)]<br />        <span class="keyword">else</span><br />          move_id = <span class="variable">@state_transitions</span>[game.state_id].max{ |(ma,sa),(mb,sb)|<br />            <span class="variable">@state_values</span>[sa] &lt;=&gt; <span class="variable">@state_values</span>[sb]<br />          }[0]<br />          move = moves.select{|m| m.move_id == move_id}[0]<br />        <span class="keyword">end</span><br />        move<br />      <span class="keyword">end</span><br /><br />      <span class="keyword">def</span> inform_of_move(before, after, move)<br />        <span class="variable">@states_visited</span> &lt;&lt; before.state_id &lt;&lt; after.state_id<br />        (<span class="variable">@state_transitions</span>[before.state_id] ||= {})[move.move_id] =<br />          after.state_id<br /><br />        <span class="keyword">if</span> after.final?<br />          winner = after.winner<br />          <span class="keyword">if</span> winner<br />            value = winner == <span class="keyword">self</span>.player ? 100.0 : -1000.0<br />          <span class="keyword">else</span><br />            value = 0.0<br />          <span class="keyword">end</span><br /><br />          factor = 1.0<br />          <span class="keyword">while</span> state = <span class="variable">@states_visited</span>.pop<br />            <span class="variable">@state_values</span>[state] = (1.0 - factor) * <span class="variable">@state_values</span>[state] +<br />              factor * value<br />            factor *= 0.5<br />          <span class="keyword">end</span><br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>The initialize() method sets up Brian's @state_values and @state_transitions, which constitute the AI's brain.</p>
			<p>@state_values will hold scores for the positions the AI has won or lost with before.  @state_transitions holds a "map" of how to get from position to position.  When these are filled in, the AI will have "learned" what positions are desirable and how it can reach them.</p>
			<p>Knowing this, choose_move() is easy to breakdown.  It checks to see if it knows anything about the moves from the current position.  If it does, it selects the highest score it can find for itself (else branch).  If it doesn't, it goes with a random choice from all available moves (if branch).</p>
			<p>The final piece of the puzzle is inform_of_move().  This method remembers all moves made in the game, mainly.  When it sees a final position, it scores all those moves based on whether it won or lost.  The scoring scale is slanted, to encourage the AI to avoid losses.</p>
			<p>That's the heart of Brian's solution.  The rest of the code is interface, client/server, a perfect minimax player, and Tic-Tac-Toe details.</p>
			<p>For the curious, this quiz was inspired by the research of Donald Michie.  In 1961 he built a "machine" that learned to play perfect Tic-Tac-Toe against humans, using matchboxes and beads.  He called the machine MENACE (Matchbox Educable Naughts And Crosses Engine).</p>
			<p>304 matchboxes where labeled with images of Tic-Tac-Toe positions and filled with colored beads representing possible moves.  At each move, a bead would be rattled out of the proper box to determine a move.  When MENACE would win, more beads of the colors played would be added to each position box.  When it would lose, the beads were left out to discourage these moves.</p>
			<p>Michie claimed that he trained MENACE in 220 games, being beaten by it eight out of the final ten games.</p>
			<p>Thanks to those who tried this one, successful or not.  Sorry it turned out to be a bit involved.</p>
			<p>Tomorrow, "How Ruby Can Help You Beat Your Grandmother In Scrabble" is the topic.  If your grandmother is anything like mine, you'll appreciate all the help you can get!</p>
		</div>
		<div id="logo"><img src="/web/20120121213151im_/http://rubyquiz.com/images/ruby_quiz_logo.jpg" alt="" width="157" height="150" /></div>
		<div id="links">
			<span class="title">Quiz Solutions</span>
			<ol>
				<li><a href="/web/20120121213151/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/123429">Brian Schr&ouml;der</a></li>
				<li><a href="/web/20120121213151/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/123431">Brian Schr&ouml;der (2)</a></li>
				<li><a href="/web/20120121213151/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/123669">Thomas Leitner</a></li>
				<li><a href="/web/20120121213151/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/123752">Thomas Leitner (2)</a></li>
			</ol>
			<p><a href="/web/20120121213151/http://rubyquiz.com/quiz11_sols.zip">Download Solutions</a></p>
			<p><a href="/web/20120121213151/http://rubyquiz.com/index.html">Back to Quiz Listing</a></p>
		</div>
		<div id="footer">&nbsp;</div>
	</div>
</body>
</html>





<!--
     FILE ARCHIVED ON 21:31:51 Jan 21, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:09:08 Jun 5, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
