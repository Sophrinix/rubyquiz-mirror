<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<!-- Start Wayback Rewrite JS Include -->
<script type="text/javascript" src="/static/js/jwplayer/jwplayer.js" ></script>
<script type="text/javascript" src="/static/js/video-embed-rewriter.js"></script>
<script type="text/javascript">
function initYTVideo(id)
{
	_wmVideos_.init("/web/", id);
}
</script>
<!-- End Wayback Rewrite JS Include -->

  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>Ruby Quiz - Process Rings (#135)</title>
	<link rel="stylesheet" type="text/css" href="/web/20120121200313cs_/http://rubyquiz.com/quiz.css" />
	<link rel="stylesheet" type="text/css" href="/web/20120121200313cs_/http://rubyquiz.com/print.css" media="print" />
</head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/rubyquiz.com\/quiz135.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Jan";
var displayYear = "2012";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://rubyquiz.com/quiz135.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20120121200313" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127172130/http://rubyquiz.com/quiz135.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>NOV</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 20:03:13 Jan 21, 2012">JAN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20120418065025/http://www.rubyquiz.com/quiz135.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2012"><strong>APR</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120103142458/http://www.rubyquiz.com/quiz135.html" title="14:24:58 Jan 3, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 20:03:13 Jan 21, 2012">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120418065025/http://www.rubyquiz.com/quiz135.html" title="6:50:25 Apr 18, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127172130/http://rubyquiz.com/quiz135.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 20:03:13 Jan 21, 2012">2012</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20130215052509/http://rubyquiz.com/quiz135.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Feb 2013"><strong>2013</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20120121200313*/http://rubyquiz.com/quiz135.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>25 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">21 Apr 07 - 15 Feb 13</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000100000000_2008:-1:000000000010_2009:-1:000000000000_2010:-1:100000000010_2011:-1:000000000000_2012:0:20016000a100_2013:-1:010000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	<div id="page">
		<div id="header"><span class="ruby">Ruby</span> <span class="quiz">Quiz</span></div>
		<div id="content">
			<span class="title">Process Rings (#135)</span>
			<p>I recently wrote about a challenge in the Programming Erlang book on my blog:</p>
			<p><a href="/web/20120121200313/http://blog.grayproductions.net/articles/2007/08/13/erlang-message-passing">Erlang Message Passing</a></p>
			<p>Language comparison issues aside, just figuring out how to build a ring of "processes" was quite the brain bender for me.  That always makes for good Ruby Quiz material, in my opinion.</p>
			<p>The task is straight forward:</p>
			<p class="example">1. Your program should take two command-line arguments:  a number of<br />   processes and a number of cycles.<br />2. Begin by creating the requested number of processes, in a ring.<br />   For example, when three processes are requested, process one<br />   creates and sends messages to process two, which creates and sends<br />   messages to process three.  The third process then sends its<br />   messages back to process one.<br />3. Pass a message around your ring of processes a number of times<br />   equal to the requested cycles.  Print timing results for how<br />   long this takes.</p>
			<p>The message you pass doesn't much matter.  A simple String is fine.  You may also wish to pass a counter with it, to verify the correct number of sends.</p>
			<p>I'll leave the definition of "processes" intentionally vague.  Ruby doesn't have an equivalent to Erlang processes so we will just say that each process should represent a node where we could run some instructions concurrently.  Be creative.</p>
			<hr />
			<p><span class="title">Quiz Summary</span></p>
			<p>I can't speak for the other solvers of course, but this kind of system programming is always complex for me.  I had to fiddle with my own solutions for quite some time to get everything working as expected.  In my fork()ed ring, I particularly struggled with the pipe creation dance.  This kind of task is also hard for me to think of good unit testing strategies for, so I struggled through it without my usual safety net.</p>
			<p>To break down a solution, let's go with James Koppel's code.  It's a Threaded version and a little easier to follow than my own attempt.  Here's the setup code:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="global">$processes</span> = []<br /><br />    <span class="keyword">def</span> kill_processes<br />      <span class="global">$processes</span>.each <span class="keyword">do</span> |thr|<br />        thr.exit!<br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="comment"># ...</span><br /><br /></div></div>
			<p>James begins by carving out some space to hold his "processes," really Threads in this case, in a global variable.  A helper is also defined here to kill all of those Threads off at the end of the program execution.</p>
			<p>The next bit of code defines what each process does.  It defines a Proc object that calls itself recursively both to build the ring and pass messages.  Let's take on just the ring building half first:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment"># ...</span><br /><br />    thread_proc = proc <span class="keyword">do</span><br />      Thread.stop<br />      <span class="keyword">if</span> Thread.current[:count] == 0<br />        Thread.current[:<span class="keyword">next</span>] = <span class="global">$processes</span>.first<br />      <span class="keyword">else</span><br />        Thread.current[:<span class="keyword">next</span>] = Thread.new(&amp;thread_proc)<br />        Thread.current[:<span class="keyword">next</span>][:count] = Thread.current[:count] - 1<br />        <span class="global">$processes</span>.push(Thread.current[:<span class="keyword">next</span>])<br />        <span class="keyword">true</span> <span class="keyword">until</span> Thread.current[:<span class="keyword">next</span>].stop?<br />        Thread.current[:<span class="keyword">next</span>].run<br />      <span class="keyword">end</span><br /><br />      <span class="comment"># ...</span><br /><br /></div></div>
			<p>Don't let all those calls to Thread.current() scare you, this code is very simple.  This Proc is meant to be passed as the body of a Thread, so the very first thing is does is stop() the newly created Thread.  This allows the creator to do some setup, then trigger the Thread to run().</p>
			<p>The if/else branch does the process creation, just by trimming down a counter.  For each point, the code points the :next Thread local variable at a new Thread that recursively calls this Proc.  The new Thread is given a lower count and the cycle repeats.  When we reach zero, the final Thread points itself at the first one created and we have ourselves a ring.</p>
			<p>If you haven't seen it before, this code makes heavy use of Ruby's Thread local variable accessors.  The short story is that you can treat a Thread as a Hash to access some Thread local storage.  So everywhere you see Thread.current above, James is accessing a Thread local variable for the currently running Thread.  Similarly, Thread.current[:next] gives us the next Thread in the ring.</p>
			<p>Here's the second half of the Proc, the message passing code:</p>
			<div class="code"><span class="type">ruby</span><div class="body">      <span class="comment"># ...</span><br /><br />      <span class="keyword">while</span> <span class="keyword">true</span><br />        Thread.stop<br />        msg = Thread.current[:message]<br />        cnt = Thread.current[:message_count]<br /><br />        Thread.current[:message] = <span class="keyword">nil</span><br />        Thread.current[:message_count] = <span class="keyword">nil</span><br /><br />        <span class="keyword">if</span> cnt == 0<br />          kill_processes<br />        <span class="keyword">else</span><br />          Thread.current[:<span class="keyword">next</span>][:message_count] = cnt - 1<br />          Thread.current[:<span class="keyword">next</span>][:message] = msg<br />          <span class="comment"># On small rings, the message can circle around before the</span><br />          <span class="comment"># first thread has stopped</span><br />          <span class="keyword">true</span> <span class="keyword">until</span> Thread.current[:<span class="keyword">next</span>].stop?<br />          Thread.current[:<span class="keyword">next</span>].run<br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="comment"># ...</span><br /><br /></div></div>
			<p>This works almost exactly like the code we just examined.  It stop()s the Thread, sets variables for the message and count, and taps the next Thread to run.  When the count is exhausted, all Threads simply exit.</p>
			<p>The application code that kicks this process off is all we have left:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment"># ...</span><br /><br />    processes, cycles = ARGV.map{|n| n.chomp.to_i}<br /><br />    <span class="global">$processes</span>.push(Thread.new(&amp;thread_proc))<br />    <span class="keyword">true</span> <span class="keyword">until</span> <span class="global">$processes</span>.first.stop?<br />    <span class="global">$processes</span>.first[:count] = processes - 1<br />    <span class="global">$processes</span>.first.run<br /><br />    puts <span class="string">"Creating #{processes} processes..."</span><br />    sleep(0.1) <span class="keyword">until</span> <span class="global">$processes</span>.length == processes<br /><br />    puts <span class="string">"Timer started."</span><br />    start_time = Time.new<br /><br />    puts <span class="string">"Sending a message around the ring #{cycles} times..."</span><br />    <span class="global">$processes</span>.first[:message_count] = processes * cycles<br />    <span class="global">$processes</span>.first[:message] = <span class="string">"Good day!"</span><br />    <span class="global">$processes</span>.first.run<br /><br />    sleep(0.1) <span class="keyword">while</span> <span class="global">$processes</span>.first.alive?<br /><br />    puts <span class="string">"Done."</span><br />    puts <span class="string">"Time in seconds: "</span> + (Time.new.to_i - start_time.to_i).to_s<br /><br /></div></div>
			<p>Again, this code is much like what we have already examined.  The code here is simplified though, since it only needs to interact with the first Thread created.</p>
			<p>I want to add a few observations about this code.</p>
			<p>First, aside from the main Thread used to monitor the process, this code does not do any concurrent processing.  Each thread is stopped between message passes and restarted when it's time to do more work.  The code can be adapted to work concurrently, say if some processing was needed at each step, but we need to introduce some form of synchronization when we add that.  You can have a look at my own Threaded solution for one way to go about that.</p>
			<p>The other point that surprised me about this code is that it's quite a bit slower than my own Threaded code.  I expected it to be much faster without the synchronization.  I'm guessing that all of that Thread stop()ping and run()ning slows things down a bit, but that's just a guess.</p>
			<p>My thanks to the other solvers who sent in mighty clever code.  Be sure and have a look at those solutions as well.  Definitely don't miss the virtual machine in pure Ruby from Adam Shelly.</p>
			<p>Tomorrow we will try some binary parsing...</p>
		</div>
		<div id="logo"><img src="/web/20120121200313im_/http://rubyquiz.com/images/ruby_quiz_logo.jpg" alt="" width="157" height="150" /></div>
		<div id="links">
			<span class="title">Quiz Solutions</span>
			<ol>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265444">Tom Danielsen</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265450">James Edward Gray II</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265497">Tom Danielsen (2)</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265559">James Koppel</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265704">Robert Dober</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265815">Adam Shelly</a></li>
				<li><a href="/web/20120121200313/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/265866">Tom</a></li>
			</ol>
			<p><a href="/web/20120121200313/http://rubyquiz.com/quiz135_sols.zip">Download Solutions</a></p>
			<p><a href="/web/20120121200313/http://rubyquiz.com/index.html">Back to Quiz Listing</a></p>
		</div>
		<div id="footer">&nbsp;</div>
	</div>
</body>
</html>





<!--
     FILE ARCHIVED ON 20:03:13 Jan 21, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:10:58 Jun 5, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
