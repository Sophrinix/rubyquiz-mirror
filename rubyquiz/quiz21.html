<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<!-- Start Wayback Rewrite JS Include -->
<script type="text/javascript" src="/static/js/jwplayer/jwplayer.js" ></script>
<script type="text/javascript" src="/static/js/video-embed-rewriter.js"></script>
<script type="text/javascript">
function initYTVideo(id)
{
	_wmVideos_.init("/web/", id);
}
</script>
<!-- End Wayback Rewrite JS Include -->

	<title>Ruby Quiz - Phone Typing (#21)</title>
	<link rel="stylesheet" type="text/css" href="/web/20120121191452cs_/http://rubyquiz.com/quiz.css" />
	<link rel="stylesheet" type="text/css" href="/web/20120121191452cs_/http://rubyquiz.com/print.css" media="print" />
</head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/rubyquiz.com\/quiz21.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Jan";
var displayYear = "2012";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://rubyquiz.com/quiz21.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20120121191452" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20110824082549/http://www.rubyquiz.com/quiz21.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="24 Aug 2011"><strong>AUG</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 19:14:52 Jan 21, 2012">JAN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20120418063629/http://www.rubyquiz.com/quiz21.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2012"><strong>APR</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120103142404/http://www.rubyquiz.com/quiz21.html" title="14:24:04 Jan 3, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 19:14:52 Jan 21, 2012">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120418063629/http://www.rubyquiz.com/quiz21.html" title="6:36:29 Apr 18, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127173036/http://rubyquiz.com/quiz21.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 19:14:52 Jan 21, 2012">2012</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20130215052604/http://rubyquiz.com/quiz21.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Feb 2013"><strong>2013</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20120121191452*/http://rubyquiz.com/quiz21.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>30 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">24 Apr 06 - 15 Feb 13</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000110000100_2007:-1:000000000000_2008:-1:000010000000_2009:-1:000000000000_2010:-1:100000000010_2011:-1:000000010000_2012:0:20018000a100_2013:-1:010000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	<div id="page">
		<div id="header"><span class="ruby">Ruby</span> <span class="quiz">Quiz</span></div>
		<div id="content">
			<span class="title">Phone Typing (#21)</span>
			<p>by Hans Fugal</p>
			<p>I am amazed whenever I see or hear about the rising generation of keypad
punchers. People that can carry on IM conversations with a 12-key phone
pad without instantly going mad; it's mind-boggling. As adaptive as the
rising generation is, the "Multitap" solution is far from efficient. For
example, I learned from Wheel of Fortune that the most common letters
are RSTLNE, only one of which (T) is the first tap on one of the keys. </p>
			<p>Your mission then, should you choose to accept it, is to develop a more
efficient algorithm for key entry. User interaction is simply the 12
keys (0-9, * and #) with <a href="/web/20120121191452/http://www.yorku.ca/mack/uist01-f1.jpg">the letters printed on them as usual</a>, and
visual feedback of what they have typed so far. Simulating algorithms
thought up by other people (e.g. <a href="/web/20120121191452/http://www.yorku.ca/mack/uist01.html">LetterWise</a>) is fair game.</p>
			<p>[ Editor's Note:</p>
			<p>Hans sent the following code to get people started with a simple testing inteface for their algorithms:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> TapEvent<br />      attr_reader :<span class="keyword">when</span>, :digit<br />      <span class="keyword">def</span> initialize(digit)<br />        <span class="variable">@digit</span> = digit<br />        <span class="variable">@when</span> = Time.now<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> to_s<br />        <span class="variable">@digit</span><br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="keyword">class</span> PhonePad<br />      attr_reader :text, :cursor<br />      <span class="keyword">def</span> set_text(text,cursor)<br />        <span class="variable">@text</span> = text<br />        <span class="variable">@cursor</span> = cursor<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> register(&amp;block)<br />        <span class="variable">@observers</span>.push block<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> initialize<br />        <span class="variable">@observers</span> = []<br />        <span class="variable">@text</span> = <span class="string">''</span><br />        <span class="variable">@cursor</span> = 0<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> notify_observers(digit)<br />        <span class="keyword">if</span> digit =~ <span class="string">/[0-9*#]/</span><br />          <span class="variable">@observers</span>.each { |block| block.call(TapEvent.new(digit)) }<br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="keyword">class</span> CLIPhonePad &lt; PhonePad<br />      <span class="keyword">def</span> initialize<br />        <span class="keyword">super</span><br />        Thread.new <span class="keyword">do</span><br />          <span class="keyword">while</span> <span class="keyword">not</span> <span class="global">$stdin</span>.eof? <span class="keyword">do</span><br />        <span class="global">$stdin</span>.readline.split(<span class="string">''</span>).each { |c| notify_observers(c) }<br />          <span class="keyword">end</span><br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> set_text(text,cursor)<br />        <span class="keyword">super</span>(text,cursor)<br />        puts to_s<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> run<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> to_s<br />        <span class="variable">@text</span>.dup.insert(<span class="variable">@cursor</span>,<span class="string">'_'</span>)<br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="keyword">if</span> <span class="global">$0</span> == <span class="keyword">__FILE__</span><br />      p = CLIPhonePad.new<br /><br />      p.register <span class="keyword">do</span> |ev|<br />        puts <span class="string">"#{ev} at #{ev.when}"</span><br />        p.set_text(p.text+ev.digit, p.cursor+1)<br />      <span class="keyword">end</span><br /><br />      Thread.list[0].join<br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>Hans's code is well suited to GUI adaption, if you're so inclined.  (Please post to Ruby Talk if you do build a GUI for this.  That's not a spoiler.)</p>
			<p>Here's another version by me, that doesn't require you press return after the digits:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">begin</span><br />        require <span class="string">"Win32API"</span><br /><br />        <span class="keyword">def</span> read_char<br />            Win32API.new(<span class="string">"crtdll"</span>, <span class="string">"_getch"</span>, [], <span class="string">"L"</span>).Call<br />        <span class="keyword">end</span><br />    <span class="keyword">rescue</span> LoadError<br />        <span class="keyword">def</span> read_char<br />            system <span class="string">"stty raw -echo"</span><br />            STDIN.getc<br />        <span class="keyword">ensure</span><br />            system <span class="string">"stty -raw echo"</span><br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    loop <span class="keyword">do</span><br />        char = read_char.chr<br />        <span class="keyword">case</span> char<br />        <span class="keyword">when</span> <span class="string">/^(?:\d|\*|#)$/</span><br />            <span class="comment">### Replace the following line with your algorithm. ###</span><br />            puts <span class="string">"You entered #{char}."</span><br />        <span class="keyword">when</span> <span class="string">/q/</span>i<br />            <span class="keyword">break</span><br />        <span class="keyword">else</span><br />            puts <span class="string">"'#{char}' is not a key on the keypad."</span><br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>-JEG2 ]</p>
			<p>This is an area of serious research for <a href="/web/20120121191452/http://www.yorku.ca/mack/uist01.html">some people</a>; don't fret it if
your algorithm isn't perfect or ideal, and don't spend too long on it. ;-) 
Make your goal to be better than dumb, which is to say be better
than "Multitap".</p>
			<hr />
			<p><span class="title">Quiz Summary</span></p>
			<p>The topic of this week's quiz was very interesting to me.  I regret that I couldn't steal enough time to try a solution of my own.  However, I've enjoyed playing with the solutions quite a bit.  Thanks Hans!</p>
			<p>So what's all the fuss about?  Let's run a simple test, using Dave Burt's solution (because it puts each step on a new line).  The following is me typing a simple sentence with the multitap method.  (Note:  I did modify one line of Dave's code used here, to make the digits come last as they do on my phone and in Brian's solution.)  Forgive the length, but in a way it's telling:</p>
			<p class="example">m_<br />mw_<br />mx_                                        # second keypress<br />my_                                        # third keypress<br />my _<br />my w_<br />my wg_<br />my wh_                                     # second keypress<br />my wi_                                     # third keypress<br />my wid_<br />my wie_                                    # second keypress<br />my wif_                                    # third keypress<br />my wifd_<br />my wife_                                   # second keypress<br />my wife _<br />my wife d_<br />my wife da_<br />my wife dam_<br />my wife dan_                               # second keypress<br />my wife dana_<br />my wife danap_<br />my wife danaq_                             # second keypress<br />my wife danar_                             # third keypress<br />my wife danas_                             # fourth keypress<br />my wife danas _<br />my wife danas a_<br />my wife danas b_                           # second keypress<br />my wife danas bg_<br />my wife danas bh_                          # second keypress<br />my wife danas bi_                          # third keypress<br />my wife danas bip_<br />my wife danas biq_                         # second keypress<br />my wife danas bir_                         # third keypress<br />my wife danas birt_<br />my wife danas birtg_<br />my wife danas birth_                       # second keypress<br />my wife danas birthd_<br />my wife danas birthda_<br />my wife danas birthdaw_<br />my wife danas birthdax_                    # second keypress<br />my wife danas birthday_                    # third keypress<br />my wife danas birthday _<br />my wife danas birthday g_<br />my wife danas birthday h_                  # second keypress<br />my wife danas birthday i_                  # third keypress<br />my wife danas birthday ip_<br />my wife danas birthday iq_                 # second keypress<br />my wife danas birthday ir_                 # third keypress<br />my wife danas birthday is_                 # fourth keypress<br />my wife danas birthday is _<br />my wife danas birthday is a_<br />my wife danas birthday is ap_<br />my wife danas birthday is app_<br />my wife danas birthday is apq_             # second keypress<br />my wife danas birthday is apr_             # third keypress<br />my wife danas birthday is aprg_<br />my wife danas birthday is aprh_            # second keypress<br />my wife danas birthday is apri_            # third keypress<br />my wife danas birthday is aprij_<br />my wife danas birthday is aprik_           # second keypress<br />my wife danas birthday is april_           # third keypress<br />my wife danas birthday is april _<br />my wife danas birthday is april d_<br />my wife danas birthday is april e_         # second keypress<br />my wife danas birthday is april eg_<br />my wife danas birthday is april eh_        # second keypress<br />my wife danas birthday is april ei_        # third keypress<br />my wife danas birthday is april eig_<br />my wife danas birthday is april eigg_<br />my wife danas birthday is april eigh_      # second keypress<br />my wife danas birthday is april eight_<br />my wife danas birthday is april eightg_<br />my wife danas birthday is april eighth_    # second keypress</p>
			<p>Here's the same exercise, with LetterWise:</p>
			<p class="example">o_<br />_                                          # had to push *<br />m_<br />my_<br />my _<br />my w_<br />my wh_<br />my w_                                      # had to push *<br />my wi_<br />my wid_<br />my wi_                                     # had to push *<br />my wif_<br />my wife_<br />my wife _<br />my wife f_<br />my wife _                                  # had to push *<br />my wife d_<br />my wife da_<br />my wife dan_<br />my wife danc_<br />my wife dan_                               # had to push *<br />my wife dana_<br />my wife danas_<br />my wife danas _<br />my wife danas a_<br />my wife danas _                            # had to push *<br />my wife danas b_<br />my wife danas bi_<br />my wife danas bir_<br />my wife danas birt_<br />my wife danas birth_<br />my wife danas birthe_<br />my wife danas birth_                       # had to push *<br />my wife danas birthd_<br />my wife danas birthda_<br />my wife danas birthday_<br />my wife danas birthday _<br />my wife danas birthday h_<br />my wife danas birthday _                   # had to push *<br />my wife danas birthday i_<br />my wife danas birthday is_<br />my wife danas birthday is _<br />my wife danas birthday is a_<br />my wife danas birthday is as_<br />my wife danas birthday is a_               # had to push *<br />my wife danas birthday is ar_<br />my wife danas birthday is a_               # had to push *, a second time<br />my wife danas birthday is ap_<br />my wife danas birthday is app_<br />my wife danas birthday is ap_              # had to push *<br />my wife danas birthday is apr_<br />my wife danas birthday is apri_<br />my wife danas birthday is april_<br />my wife danas birthday is april _<br />my wife danas birthday is april f_<br />my wife danas birthday is april _          # had to push *<br />my wife danas birthday is april d_<br />my wife danas birthday is april _          # had to push *, a second time<br />my wife danas birthday is april e_<br />my wife danas birthday is april ei_<br />my wife danas birthday is april eig_<br />my wife danas birthday is april eigh_<br />my wife danas birthday is april eight_<br />my wife danas birthday is april eighti_<br />my wife danas birthday is april eight_     # had to push *<br />my wife danas birthday is april eighth_</p>
			<p>(I'm sure Dana will be looking forward to all your gifts this year.)</p>
			<p>That's a pretty radical difference.  Let me line up those stats:</p>
			<p class="example">               Multitap  LetterWise<br />  keypresses:  74          52<br />second press:  20 (27%)    12 (23%)<br /> third press:  14 (19%)     2 (4%)<br />fourth press:   2 (3%)      0</p>
			<p>However, and this is purely subjective so feel free to completely ignore it, I'm almost positive I entered the sentence faster with Multitap.  Isn't that ironic?  The reason is that I can glance at the keypad and know exactly what I need to do.  With LetterWise, I had to wait and see what I got, before I could respond.  The document linked to by the quiz seemed to imply this was a phase I would get past, eventually.</p>
			<p>So, between the two methods explored in the solution, LetterWise is definitely a by the numbers improvement.  Subjectively though, it may take some getting use to.  Try it for yourself.</p>
			<p>Oh, should I be talking about Ruby here?  Right, let's get on that.</p>
			<p>I want to take a look at Dave Burt's code that was used in the examples above, but not all of it.  I'll leave out his TK interface and a few classes mainly useful in testing.</p>
			<p>First, Dave combined the code Hans and I offered with the quiz to build a better command-line interface.  Here's the class for that:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> CharPhonePad &lt; PhonePad<br />      <span class="keyword">def</span> initialize<br />        <span class="keyword">super</span><br />        Thread.new <span class="keyword">do</span><br />          loop <span class="keyword">do</span><br />            <span class="keyword">case</span> c = <span class="keyword">self</span>.<span class="keyword">class</span>.read_char<br />            <span class="keyword">when</span> 3, 4, 26, 27  <span class="comment"># Break on Ctrl+C, Ctrl+D, Ctrl+Z, Escape</span><br />              <span class="keyword">break</span><br />            <span class="keyword">when</span> 43  <span class="comment"># convert '+' to '*' for ease of typing on numpad</span><br />              c = 42<br />            <span class="keyword">when</span> 45, 46, 47 <span class="comment"># convert '-', '.', '/' to '#' for ease of typing</span><br />              c = 35<br />            <span class="keyword">end</span><br />            notify_observers(c.chr)<br />          <span class="keyword">end</span><br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> set_text(text, cursor)<br />        <span class="keyword">super</span>(text, cursor)<br />        puts to_s<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> to_s<br />        <span class="variable">@text</span>.dup.insert(<span class="variable">@cursor</span>, <span class="string">'_'</span>)<br />      <span class="keyword">end</span><br /><br />      <span class="keyword">begin</span><br />        require <span class="string">"Win32API"</span><br />        <span class="keyword">def</span> <span class="keyword">self</span>.read_char<br />          c = Win32API.new(<span class="string">"crtdll"</span>, <span class="string">"_getch"</span>, [], <span class="string">"L"</span>).Call<br />        <span class="keyword">end</span><br />      <span class="keyword">rescue</span> LoadError<br />        <span class="keyword">def</span> <span class="keyword">self</span>.read_char<br />          system <span class="string">"stty raw -echo"</span><br />          STDIN.getc<br />        <span class="keyword">ensure</span><br />          system <span class="string">"stty -raw echo"</span><br />        <span class="keyword">end</span><br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>Nothing real surprising there.  Dave just extended Hans's framework with my character reading methods.  It's a nicer option than what I offered because you can use the event system.  Note the character case block adds some niceties for using your keyboard number pad.</p>
			<p>Next, here's Dave's Multipress/Multitap implementation:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> TapHandler<br />      <span class="keyword">def</span> initialize(phone_pad)<br />        <span class="variable">@p</span> = phone_pad<br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="keyword">class</span> MultipressTapHandler &lt; TapHandler<br />      attr_accessor :timeout<br />      <span class="keyword">def</span> initialize(phone_pad, timeout = 1.5)<br />        <span class="keyword">super</span>(phone_pad)<br />        <span class="variable">@timeout</span> = timeout<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> process_event(ev)<br />        <span class="keyword">if</span> (<span class="variable">@last_event</span> &amp;&amp;<br />            ev.digit == <span class="variable">@last_event</span>.digit &amp;&amp;<br />            Time.now - <span class="variable">@last_event</span>.<span class="keyword">when</span> &lt; timeout)<br />          char_set = PhonePad::InputMap[ev.digit]<br />          char_index = (char_set.index(<span class="variable">@p</span>.text[-1].chr) + 1) % char_set.size<br />          <span class="variable">@p</span>.set_text(<span class="variable">@p</span>.text[0..-2] + char_set[char_index], <span class="variable">@p</span>.cursor)<br />        <span class="keyword">else</span><br />        <span class="comment">### modified by JEG2 for discussion example ###</span><br />          <span class="variable">@p</span>.set_text(<span class="variable">@p</span>.text+PhonePad::InputMap[ev.digit][0], <span class="variable">@p</span>.cursor+1)<br />        <span class="comment">### actual code by Dave Burt ###</span><br />        <span class="comment">#  @p.set_text(@p.text+ev.digit, @p.cursor+1)</span><br />        <span class="keyword">end</span><br />        <span class="variable">@last_event</span> = ev<br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>All the exciting work in there happens in process_event().  The if checks to see if it has memorized a previous event.  If it has and this new event is the same digit and the timout for that press hasn't expired yet, the next character in the InputMap is selected.   In all other cases, the first character of the InputMap is selected.  That's all there is to Multitap.</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> LetterWiseTapHandler &lt; TapHandler<br />      <span class="comment"># method taken from:</span><br />      <span class="comment"># MacKenzie, I. S., Kober, H., Smith, D., Jones, T., Skepner, E. (2001).</span><br />      <span class="comment"># LetterWise: Prefix-based disambiguation for mobile text input.</span><br />      <span class="comment"># Proceedings of the ACM Symposium on User Interface Software and</span><br />      <span class="comment"># Technology - UIST 2001, pp. 111-120. New York: ACM.</span><br />      <span class="comment"># http://www.yorku.ca/mack/uist01.html</span><br /><br />      <span class="comment"># A lot of the logic in this method is captured in the InputMap,</span><br />      <span class="comment"># which maps prefixes of up to 3 letters and a key (0-9) onto </span><br />      <span class="comment"># an array of letters inmost-likely-first order.</span><br /><br />      <span class="comment">#require 'yaml'</span><br />      <span class="comment"># 1.8MB, ~ 6 seconds to load</span><br />      <span class="comment">#InputMap = YAML.load_file('predict3.yaml')</span><br />      <span class="comment"># 2.3MB, ~ 3 seconds to load  </span><br />      InputMap = eval(File.read(<span class="string">'predict3.rb'</span>))<br /><br />      <span class="keyword">def</span> initialize(phone_pad)<br />        <span class="keyword">super</span>(phone_pad)<br />        <span class="variable">@cycle</span> = [<span class="string">'*'</span>]<br />      <span class="keyword">end</span><br />      <span class="keyword">def</span> process_event(ev)<br />        prefix = <span class="variable">@p</span>.text[<span class="string">/\w{0,3}$/</span>]<br />        <span class="keyword">if</span> ev.digit == <span class="string">'*'</span>  <span class="comment"># change last letter</span><br />          <span class="variable">@cycle</span>.push <span class="variable">@cycle</span>.shift  <span class="comment"># rotate</span><br />          <span class="variable">@p</span>.set_text(<span class="variable">@p</span>.text[0..-2], <span class="variable">@p</span>.cursor - 1)<br />        <span class="keyword">elsif</span> InputMap[prefix]<br />          <span class="variable">@cycle</span> = InputMap[prefix][ev.digit].dup<br />        <span class="keyword">else</span><br />          <span class="variable">@cycle</span> = InputMap[<span class="keyword">nil</span>][ev.digit].dup<br />        <span class="keyword">end</span><br />        <span class="variable">@cycle</span> ||= <span class="string">%w[. ! - &amp; @ $ * +]</span><br />        <span class="variable">@p</span>.set_text(<span class="variable">@p</span>.text + <span class="variable">@cycle</span>[0], <span class="variable">@p</span>.cursor + 1)<br />      <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>As the comments suggest, there's not a lot of logic in here.  Surprisingly, there isn't that much in the evaled predict3.rb file either.  It's just one big boring hash, which you can see for yourself, if you follow the links to Dave's solution.</p>
			<p>Again, process_event() is where the action is.  Really, it just looks up the last three letters entered in the InputMap to find the order of the letters (the elsif part) or cycles to the next most likely letter (the if part).  The system seems to support some punctuation characters, but I couldn't figure out how to get at them when using it.</p>
			<p>Here's the code that kicks off the process:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">if</span> <span class="global">$0</span> == <span class="keyword">__FILE__</span><br /><br />      <span class="comment">#p = CLIPhonePad.new  # Command-line interface</span><br />      p = CharPhonePad.new  <span class="comment"># Raw command-line interface</span><br />      <span class="comment">#p = TkPhonePad.new  # TK interface</span><br /><br />      <span class="comment"># just dump digits pressed</span><br />      <span class="comment">#tap_handler = NoOpTapHandler.new(p)</span><br />      <span class="comment"># tap the shape of a letter on the keypad!</span><br />      <span class="comment">#tap_handler = IconicTapHandler.new(p)</span><br />      <span class="comment"># standard multi-press, 1.5s timeout</span><br />      <span class="comment">#tap_handler = MultipressTapHandler.new(p)</span><br />      <span class="comment"># letter-wise prediction; * to change letter</span><br />      tap_handler = LetterWiseTapHandler.new(p)<br /><br />      p.register <span class="keyword">do</span> |ev|<br />        tap_handler.process_event(ev)<br />      <span class="keyword">end</span><br /><br />      Thread.list[0].join<br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>Dave, repeat after me, "optparse is my friend..."  Be kind to the guy who plays with your code, because it might be me.  Here's that and more without the comment dance:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">if</span> <span class="global">$0</span> == <span class="keyword">__FILE__</span><br />        require <span class="string">"optparse"</span><br /><br />        <span class="comment"># defaults</span><br />        pad = :raw<br />        tap = :letterwise<br /><br />        <span class="comment"># parse options</span><br />        opts = OptionParser.new <span class="keyword">do</span> |opts|<br />            opts.banner = <span class="string">"Usage:  #$0 [OPTIONS]"</span><br /><br />            opts.separator <span class="string">""</span><br />            opts.separator <span class="string">"Specific Options:"</span><br /><br />            opts.on( <span class="string">"-i INTERFACE"</span>,<br />                     [:raw, :tk, :cli],<br />                     <span class="string">"Interface you would like to use:"</span>,<br />                     <span class="string">"  raw, tk or cli."</span> ) <span class="keyword">do</span> |v|<br />                pad = v<br />            <span class="keyword">end</span><br />            opts.on( <span class="string">"-m MODE"</span>,<br />                     [:letterwise, :multipress, :iconic, :noop],<br />                     <span class="string">"The input algorithm to use:"</span>,<br />                     <span class="string">"  letterwise, multipress, iconic or noop."</span> ) <span class="keyword">do</span> |v|<br />                tap = v<br />            <span class="keyword">end</span><br />            opts.on( <span class="string">"-h"</span>, <span class="string">"-?"</span>, <span class="string">"--help"</span>,<br />                     <span class="string">"Show this text."</span> ) <span class="keyword">do</span><br />                puts opts<br />                exit<br />            <span class="keyword">end</span><br />        <span class="keyword">end</span><br />        opts.parse!(ARGV)<br /><br />        <span class="comment"># handle results</span><br />        <span class="keyword">case</span> pad<br />        <span class="keyword">when</span> :raw <span class="keyword">then</span> p = CharPhonePad.new<br />        <span class="keyword">when</span> :tk  <span class="keyword">then</span> p = TkPhonePad.new<br />        <span class="keyword">when</span> :cli <span class="keyword">then</span> p = CLIPhonePad.new<br />        <span class="keyword">end</span><br />        <span class="keyword">case</span> tap<br />        <span class="keyword">when</span> :letterwise <span class="keyword">then</span> tap_handler = LetterWiseTapHandler.new(p)<br />        <span class="keyword">when</span> :multipress <span class="keyword">then</span> tap_handler = MultipressTapHandler.new(p)<br />        <span class="keyword">when</span> :iconic     <span class="keyword">then</span> tap_handler = IconicTapHandler.new(p)<br />        <span class="keyword">when</span> :noop       <span class="keyword">then</span> tap_handler = NoOpTapHandler.new(p)<br />        <span class="keyword">end</span><br /><br />        <span class="comment"># run program</span><br />        p.register { |ev| tap_handler.process_event(ev) }<br />        Thread.list[0].join<br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>Brian makes them even prettier, so scan his solution for an even better example.</p>
			<p>My thanks to both Brian and Dave for playing with this one while I didn't have time to.  Also, thank you Hans for such a clever topic.</p>
			<p>Tomorrows quiz takes us all the way to Rome...</p>
		</div>
		<div id="logo"><img src="/web/20120121191452im_/http://rubyquiz.com/images/ruby_quiz_logo.jpg" alt="" width="157" height="150" /></div>
		<div id="links">
			<span class="title">Quiz Solutions</span>
			<ol>
				<li><a href="/web/20120121191452/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/132509">Dave Burt</a></li>
				<li><a href="/web/20120121191452/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/132549">Dave Burt (2)</a></li>
				<li><a href="/web/20120121191452/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/132646">Brian Schr&ouml;der</a></li>
			</ol>
			<p><a href="/web/20120121191452/http://rubyquiz.com/quiz21_sols.zip">Download Solutions</a></p>
			<p><a href="/web/20120121191452/http://rubyquiz.com/index.html">Back to Quiz Listing</a></p>
		</div>
		<div id="footer">&nbsp;</div>
	</div>
</body>
</html>





<!--
     FILE ARCHIVED ON 19:14:52 Jan 21, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:09:17 Jun 5, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
