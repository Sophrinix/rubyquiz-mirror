<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<!-- Start Wayback Rewrite JS Include -->
<script type="text/javascript" src="/static/js/jwplayer/jwplayer.js" ></script>
<script type="text/javascript" src="/static/js/video-embed-rewriter.js"></script>
<script type="text/javascript">
function initYTVideo(id)
{
	_wmVideos_.init("/web/", id);
}
</script>
<!-- End Wayback Rewrite JS Include -->

	<title>Ruby Quiz - Tiling Turmoil (#33)</title>
	<link rel="stylesheet" type="text/css" href="/web/20120121185215cs_/http://rubyquiz.com/quiz.css" />
	<link rel="stylesheet" type="text/css" href="/web/20120121185215cs_/http://rubyquiz.com/print.css" media="print" />
</head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/rubyquiz.com\/quiz33.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Jan";
var displayYear = "2012";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://rubyquiz.com/quiz33.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20120121185215" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127180544/http://rubyquiz.com/quiz33.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>NOV</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 18:52:15 Jan 21, 2012">JAN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20120418085846/http://www.rubyquiz.com/quiz33.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2012"><strong>APR</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120103143239/http://www.rubyquiz.com/quiz33.html" title="14:32:39 Jan 3, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 18:52:15 Jan 21, 2012">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120418085846/http://www.rubyquiz.com/quiz33.html" title="8:58:46 Apr 18, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127180544/http://rubyquiz.com/quiz33.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 18:52:15 Jan 21, 2012">2012</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20130215052909/http://rubyquiz.com/quiz33.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Feb 2013"><strong>2013</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20120121185215*/http://rubyquiz.com/quiz33.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>35 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">12 Apr 06 - 15 Feb 13</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000210000100_2007:-1:000000200000_2008:-1:000010000000_2009:-1:000000000000_2010:-1:000000000010_2011:-1:000000000000_2012:0:2001c000a100_2013:-1:010000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	<div id="page">
		<div id="header"><span class="ruby">Ruby</span> <span class="quiz">Quiz</span></div>
		<div id="content">
			<span class="title">Tiling Turmoil (#33)</span>
			<p>by Greg Brown</p>
			<p>This weeks quiz is based off of a mathematical proof we were taught in my discrete mathematics class a few weeks ago. Though I can already hear some of you running for the hills at the mention of the four letter word that is math, I can assure you that this is more of a thinking problem than it is number crunching. The basic idea is pretty simple.</p>
			<p>You're going to tile L-trominos on a 2**n by 2**n board that is missing a single square. What's an L-tromino? It's simply a 2 by 2 square with a corner missing that looks like an L.</p>
			<p>For further clarification, this is what they look like:</p>
			<p class="example">#<br /># #</p>
			<p>Well, I guess it's time to stop being vague and give you the problem definition.</p>
			<p>For any 2**n by 2**n board with a single square missing in a random location, you must write a program that will tile L-trominos in such a way that the grid is completely filled in.</p>
			<p>Your program should take the value for n as the input, and somehow display the board with the trominos properly laid out as the output. It should place the missing square at random each time the board is generated. (Otherwise this would be too easy!)</p>
			<p>For example, the empty board of n = 2 would be something like this:</p>
			<p class="example">_ _ _ _<br />_ _ X _<br />_ _ _ _<br />_ _ _ _</p>
			<p>The solution for that might look like:</p>
			<p class="example">1 1 2 2<br />1 5 X 2<br />3 5 5 4<br />3 3 4 4</p>
			<p>As you can see, all squares are completely filled with the exception of the empty square which was randomly placed.</p>
			<p>It may look simple on a 4 by 4 board, but once you get up to a 128 by 128 or even 4096 by 4096, it becomes more and more obvious that guess and check is just not going to work.</p>
			<p>The level of difficulty of this problem depends entirely on how much you already know about it. If you want an easy ride, look for the proof and just implement it.</p>
			<p>If you want more of a challenge, avoid Googling the topic and try to find clever ways to actually show how your program solves the problem.</p>
			<p>Hope you have fun with this quiz, and if you write a really good one, you can help me tile my bathroom floor next week as a prize.  :)</p>
			<hr />
			<p><span class="title">Quiz Summary</span></p>
			<p>The quiz mentioned a mathematical proof (by Solomon Golomb), that could be used in solving this problem.  Most of the submissions used this technique and most of them even figured it out without Google's help.  Proof positive that coding in Ruby increases the IQ.</p>
			<p>Let's cover that proof.  The easiest instance of the provided challenge is when n = 1.  No matter which square is missing from that, exactly one L-tromino fits in the remaining squares.  Here are all four possibilities:</p>
			<p class="example">X 1    1 X    1 1    1 1<br />1 1    1 1    X 1    1 X</p>
			<p>Obviously, larger values on n require a little more thinking.  Only a little though, if we're clever.  When n = 2, we can divide the board into quadrants to get four 2 x 2 boards:</p>
			<p class="example">_ _ | X _<br />_ _ | _ _<br />---------<br />_ _ | _ _<br />_ _ | _ _</p>
			<p>We can easily see that one of those is just the trivial case from above.  The key insight is that the other three quadrants could be made into the same trivial case, with one well-placed L-tromino in the center:</p>
			<p class="example">_ _ | X _<br />_ 1 | _ _<br />---------<br />_ 1 | 1 _<br />_ _ | _ _</p>
			<p>Now we have four simple problems to solve, no thought required:</p>
			<p class="example">2 2 | X 3<br />2 1 | 3 3<br />---------<br />6 1 | 1 5<br />6 6 | 5 5</p>
			<p>What about n = 3 and beyond?  Well, dividing n = 3 into quadrants, with another well-placed center L-tromino, gives us four n = 2 problems.  We can solved each of those, as we did above.  Then n = 4 can be divided into four n = 3 problems.  By now, you should see the pattern.</p>
			<p>No matter how big the board gets, we can drop an L-tromino in the middle and divide it into quadrants.  We can keep reducing those sections into quadrants of their own, until we get all the way back to a bunch of trivial n = 1 problems.</p>
			<p>Here's a link to a nice graphical display of that proof, for those who still need to see it in action:</p>
			<p><a href="/web/20120121185215/http://www.cut-the-knot.org/Curriculum/Geometry/Tromino.shtml">Golomb's inductive proof</a></p>
			<p>Jannis Harder's solution produced pretty HTML output similar to what you see at the above link, but uses a different strategy to obtain the answers.  You might want to run it a few times, to examine that technique.</p>
			<p>The solutions emulating the proof, were all fairly similar in function.  Differing mainly is code style.  Let's break down one such solution by Dominik Bathon.  Here's the helper class from Dominik's code:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment">#######################################################</span><br /><br />    <span class="comment"># A simple 2D array, the width and height are immutable once it is created.</span><br />    <span class="comment"># #to_s accepts an optional block that can format the elements.</span><br />    <span class="keyword">class</span> Array2D<br />            attr_reader :w, :h<br />            <span class="keyword">def</span> initialize(w, h, defel=<span class="keyword">nil</span>)<br />                    <span class="variable">@w</span>, <span class="variable">@h</span>=w, h<br />                    <span class="variable">@array</span>=Array.new(w*h, defel)<br />            <span class="keyword">end</span><br />            <span class="keyword">def</span> [](x, y)<br />                    <span class="variable">@array</span>[(y % h) * w + (x % w)]<br />            <span class="keyword">end</span><br />            <span class="keyword">def</span> []=(x, y, v)<br />                    <span class="variable">@array</span>[(y % h) * w + (x % w)]=v<br />            <span class="keyword">end</span><br /><br />            <span class="keyword">def</span> to_s<br />                    (0...h).collect { |y|<br />                            (0...w).collect { |x|<br />                                    v=<span class="keyword">self</span>[x, y]<br />                                    block_given? ? <span class="keyword">yield</span>(v) : v<br />                            }.join <span class="string">" "</span><br />                    }.join <span class="string">"\n"</span><br />            <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="comment"># ...</span><br /><br /></div></div>
			<p>The comment tells you what we're looking at here, a two-dimensional Array. The internal storage format (setup in initialize()) is really just a normal Array, with some clever indexing that you can see in the []() and []=() methods.</p>
			<p>The to_s() method is pretty interesting.  You can see that is just generates each x and y combination and feeds those to []() to get each square.  A couple of join()s at the end of the method create first rows and then a final String from that, separating the squares with spaces and the rows with newlines.  There's a nice use of blocks here though.  Each square is passed to a block (if given), so that it may format the square for display.</p>
			<p>Now we're ready to examine the solution class:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment"># ...</span><br /><br />    <span class="keyword">class</span> TrominoTiler<br />            <span class="keyword">def</span> initialize(n)<br />                    n=[1, n].max<br />                    <span class="comment"># initialize the working array</span><br /><br />                    <span class="variable">@a</span>=Array2D.new(1 &lt;&lt; n, 1 &lt;&lt; n)<br />            <span class="keyword">end</span><br /><br />            <span class="keyword">def</span> tile_with_empty(x, y)<br />                    <span class="variable">@tilenum</span>=0 <span class="comment"># counter</span><br />                    tile_recursive(0, <span class="variable">@a</span>.w, 0, <span class="variable">@a</span>.h, x, y)<br />                    <span class="variable">@a</span><br />            <span class="keyword">end</span><br /><br />            <span class="comment"># ...</span><br /><br /></div></div>
			<p>These two methods make up the public face of the solver.  First, initialize() creates an instance of the Array2D we just examined.  Don't let the bit shifting throw you, 1 &lt;&lt; n is just another way to say the 2**n from the quiz.</p>
			<p>The other method, tile_with_empty(), takes an x and y position for the empty square and kicks-off the process to find a solution.  We can see that it sets some kind of counter, calls tile_recursive() with the dimensions of the board and the empty square coordinates, then returns the modified Array2D.  Clearly we need to see tile_recursive() to make sense of this:</p>
			<div class="code"><span class="type">ruby</span><div class="body">            <span class="comment"># ...</span><br /><br />            private<br /><br />            <span class="comment"># tiles the area of @a determined by xb,xe and yb,ye (b is begin,</span><br />            <span class="comment"># e is end, so xb,xe is like the range xb...xe) with trominos,</span><br />            <span class="comment"># leaving empty_x,empty_y empty</span><br />            <span class="keyword">def</span> tile_recursive(xb, xe, yb, ye, empty_x, empty_y)<br />                    half=(xe-xb)/2<br />                    <span class="keyword">if</span> half==1<br />                            <span class="comment"># easy, just one tromino</span><br />                            <span class="variable">@tilenum</span>+=1<br />                            <span class="comment"># set all 4 squares, empty is fixed below</span><br />                            <span class="variable">@a</span>[xb  , yb  ]=<span class="variable">@tilenum</span><br />                            <span class="variable">@a</span>[xb+1, yb  ]=<span class="variable">@tilenum</span><br />                            <span class="variable">@a</span>[xb  , yb+1]=<span class="variable">@tilenum</span><br />                            <span class="variable">@a</span>[xb+1, yb+1]=<span class="variable">@tilenum</span><br />                    <span class="keyword">else</span><br />                            <span class="comment"># tile recursive</span><br />                            mytile=(<span class="variable">@tilenum</span>+=1)<br />                            <span class="comment"># where to split the ranges</span><br />                            xh, yh=xb+half, yb+half<br />                            [ <span class="comment"># the 4 sub parts:</span><br />                            [xb, xh, yb, yh, xh-1, yh-1],<br />                            [xh, xe, yb, yh, xh  , yh-1],<br />                            [xb, xh, yh, ye, xh-1, yh  ],<br />                            [xh, xe, yh, ye, xh  , yh  ]<br />                            ].each { |args|<br />                                    <span class="comment"># if empty_x,empty_y is in this part, we</span><br />                                    <span class="comment"># have to adjust the last two arguments</span><br />                                    <span class="keyword">if</span> (args[0]...args[1]).member?(empty_x) &amp;&amp;<br />                                       (args[2]...args[3]).member?(empty_y)<br />                                            args[4]=empty_x<br />                                            args[5]=empty_y<br />                                    <span class="keyword">end</span><br />                                    tile_recursive(*args)<br />                                    <span class="variable">@a</span>[args[4], args[5]]=mytile<br />                            }<br /><br />                    <span class="keyword">end</span><br />                    <span class="comment"># fix empty square</span><br />                    <span class="variable">@a</span>[empty_x, empty_y]=<span class="keyword">nil</span><br />            <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br />    <span class="comment"># ...</span><br /><br /></div></div>
			<p>This is the heart of Dominik's solution.  The method is a code representation of the proof I outlined earlier.  It starts by locating the center of the board.  It can branch two different ways from there.  The first is when the center is 1, showing that we're dealing with the trivial n = 1 case from the proof.  When that's the case, the code fills the board with the counter we saw initialized in the previous method.  That will actually fill four squares instead of the needed three, but if you glance at the last line of the program you'll see that the empty square is cleared before we return.</p>
			<p>The other case the method deals with (the else clause), is for all bigger values of n.  Here, the method memorizes its counter, because it will be increased by the coming recursion.  Then, using the earlier found half-way point, the board is divided into four equal quadrants.  When created, the corner at the center of the board is used as the new empty square, which represents our "well placed center L-tromino" from the quiz.  The code then corrects that auto-generated empty square for the quadrant that already had one.  Finally, the method recurses by passing the dimensions of the new quadrant and the empty square for that quadrant.  After the quadrant is filled by that call, the corners are set to the counter value memorized earlier.</p>
			<p>That method will fill the entire board with numbered L-trominos by the time it returns.  The application code needed to finish off the solution is minimal:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment"># ...</span><br /><br />    <span class="keyword">if</span> <span class="global">$0</span> == <span class="keyword">__FILE__</span><br />            n=(ARGV[0] || 3).to_i<br />            d=1 &lt;&lt; n<br />            maxw=((d*d-1)/3).to_s.size<br />            tiler=TrominoTiler.new(n)<br />            <span class="comment"># show solutions for all possible empty squares</span><br />            d.times { |y|<br />                    d.times { |x|<br />                            puts tiler.tile_with_empty(x, y).to_s { |v|<br />                                    v.to_s.rjust(maxw)<br />                            }, <span class="string">""</span><br />                    }<br />            }<br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>Dominik reads the specified size or defaults, then uses two lines of clever math to determine what the largest numbered L-tromino is going to be in the result.  The code memorizes the size of that number, for use in the output block.</p>
			<p>Then we get to the solver.  An instance of TrominoTiler is created and tile_with_empty() is called not for one random square by for all possible empty squares.  Those results are shown using Array2D's to_s() method.  The passed block pads small numbers to the maximum width memorized earlier.  That gives us a complete solution.</p>
			<p>Many thanks to all you clever tilers out there.  Golomb would be proud.</p>
			<p>Ruby Quiz for next week:  Send in some fresh suggestions.  We're out of topics and need some new material.  Ruby Quiz will take a one week break to give you all time to find some and me time to participate in one of the codefests.  Enjoy the break, but don't forget to send in those ideas!</p>
		</div>
		<div id="logo"><img src="/web/20120121185215im_/http://rubyquiz.com/images/ruby_quiz_logo.jpg" alt="" width="157" height="150" /></div>
		<div id="links">
			<span class="title">Quiz Solutions</span>
			<ol>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143327">Kero</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143336">David Tran</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143358">Dominik Bathon</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143359">Matthew Westcott</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143430">David Tran (2)</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143442">Jannis Harder</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143570">Pedro</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143626">Bill Atkins</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143629">David Tran (3)</a></li>
				<li><a href="/web/20120121185215/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/143696">atgeirr</a></li>
			</ol>
			<p><a href="/web/20120121185215/http://rubyquiz.com/quiz33_sols.zip">Download Solutions</a></p>
			<p><a href="/web/20120121185215/http://rubyquiz.com/index.html">Back to Quiz Listing</a></p>
		</div>
		<div id="footer">&nbsp;</div>
	</div>
</body>
</html>





<!--
     FILE ARCHIVED ON 18:52:15 Jan 21, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:09:29 Jun 5, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
