<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>


<!-- Start Wayback Rewrite JS Include -->
<script type="text/javascript" src="/static/js/jwplayer/jwplayer.js" ></script>
<script type="text/javascript" src="/static/js/video-embed-rewriter.js"></script>
<script type="text/javascript">
function initYTVideo(id)
{
	_wmVideos_.init("/web/", id);
}
</script>
<!-- End Wayback Rewrite JS Include -->

	<title>Ruby Quiz - Kalah (#58)</title>
	<link rel="stylesheet" type="text/css" href="/web/20120121185421cs_/http://rubyquiz.com/quiz.css" />
	<link rel="stylesheet" type="text/css" href="/web/20120121185421cs_/http://rubyquiz.com/print.css" media="print" />
</head><body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/rubyquiz.com\/quiz58.html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "21";
var displayMonth = "Jan";
var displayYear = "2012";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://rubyquiz.com/quiz58.html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20120121185421" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20110826110854/http://rubyquiz.com/quiz58.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="26 Aug 2011"><strong>AUG</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 18:54:21 Jan 21, 2012">JAN</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20120418085322/http://www.rubyquiz.com/quiz58.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="18 Apr 2012"><strong>APR</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20110826110854/http://rubyquiz.com/quiz58.html" title="11:08:54 Aug 26, 2011" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 18:54:21 Jan 21, 2012">21</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20120418085322/http://www.rubyquiz.com/quiz58.html" title="8:53:22 Apr 18, 2012" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20101127175048/http://rubyquiz.com/quiz58.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="27 Nov 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 18:54:21 Jan 21, 2012">2012</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20130215052658/http://rubyquiz.com/quiz58.html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="15 Feb 2013"><strong>2013</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20120121185421*/http://rubyquiz.com/quiz58.html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>31 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">24 Apr 06 - 15 Feb 13</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000110000100_2007:-1:000100100000_2008:-1:000020000000_2009:-1:000000000000_2010:-1:100000000010_2011:-1:000000010000_2012:0:10017000a100_2013:-1:010000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	<div id="page">
		<div id="header"><span class="ruby">Ruby</span> <span class="quiz">Quiz</span></div>
		<div id="content">
			<span class="title">Kalah (#58)</span>
			<p>by Mark Van Holstyn</p>
			<p>For my Computer Science class this month, we had to program a Kalah Player. Sadly, we had to do our project in Java, but I ported the game code and the sample players to ruby for this quiz though.</p>
			<p>A good explanation of the game can be found at:</p>
			<p><a href="/web/20120121185421/http://rubyurl.com/SqU">Kalah Rules</a></p>
			<p>Your task is to create the best Kalah player you can. The player should look like the following:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> HumanPlayer &lt; Player<br />        <span class="keyword">def</span> choose_move<br />            print <span class="string">'Enter your move choice: '</span><br />            gets.chomp.to_i<br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>The 'choose_move' method is what the game will call to request a move from the player. The Player class which you player should extend looks like so:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="keyword">class</span> Player<br />        attr_accessor :name<br />        attr_writer :game, :side<br /><br />        <span class="keyword">def</span> initialize( name )<br />            <span class="variable">@name</span> = name<br />        <span class="keyword">end</span><br /><br />        <span class="keyword">def</span> choose_move<br />            <span class="keyword">if</span> <span class="variable">@side</span>==KalahGame::TOP<br />                (7..12).each { |i| <span class="keyword">return</span> i <span class="keyword">if</span> <span class="variable">@game</span>.stones_at?(i) &gt; 0 }<br />            <span class="keyword">else</span><br />                (0..5).each { |i| <span class="keyword">return</span> i <span class="keyword">if</span> <span class="variable">@game</span>.stones_at?(i) &gt; 0 }<br />            <span class="keyword">end</span><br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>The 'game' and 'side' attributes will be assigned by KalahGame. The side will either be the constant KalahGame::TOP or KalahGame::BOTTOM. This is what you will use to determine if you should be making moves from bowls 0-5 or 7-12 and whether your Kalah is 6 or 13.</p>
			<p>KalahMatch plays two games, one with each player on the each side of the board and then averages their scores, so you must make you player be able to play both on the top and the bottom.</p>
			<p>Here's a sample game engine to get you started:</p>
			<p><a href="/web/20120121185421/http://rubyquiz.com/KalahMatch.rb">Kalah Game Engine</a></p>
			<hr />
			<p><span class="title">Quiz Summary</span></p>
			<p>Both sides of the Kalah board are the same, with only the numbers of the slots changing.  You can write a little code to make it so that your players need not be concerned with this minor difference.  Here's an example from Adam Shelly:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment">#Adapter class - rotates the board so that player's Kalah is always 6</span><br />    <span class="keyword">class</span> KalahPlayer &lt; Player<br />        <span class="keyword">def</span> choose_move<br />          n = (<span class="variable">@side</span>==KalahGame::TOP) ? 7 : 0<br />            <span class="variable">@board</span> = <span class="variable">@game</span>.board<br />            <span class="variable">@board</span> = <span class="variable">@board</span>.rotate n<br />            <span class="keyword">return</span> get_move + n<br />        <span class="keyword">end</span><br /><br />        <span class="comment">#simulate a move</span><br />        <span class="keyword">def</span> simulate board,i<br />            b = board.dup<br />            stones,b[i]=b[i],0<br />            <span class="keyword">while</span> stones &gt; 0<br />                i = 0 <span class="keyword">if</span> (i+=1) &gt;12<br />                b[i]+=1<br />                stones-=1<br />            <span class="keyword">end</span><br />            <span class="keyword">if</span> (0..5)===i <span class="keyword">and</span> b[i]==1<br />                b[6]+= (b[i]+b[opposite(i)])<br />                b[i]=b[opposite(i)]=0<br />            <span class="keyword">end</span><br />            b<br />        <span class="keyword">end</span><br />        <span class="keyword">def</span> opposite n<br />            12-n<br />        <span class="keyword">end</span><br /><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>As the comment suggests, this is the Adapter Design Pattern at work.  Player's original interface is that choose_move() should return a correct move regardless of which side of the board it is playing from.  KalahPlayer changes that interface to having get_move() see the board as if it was playing from the bottom and return only moves in that range.</p>
			<p>This change is accomplished by defining a choose_move() the rotates a board and adds an offset to the players selected move, if needed.  When the player is on the bottom, the board is rotated 0 and the selected move is added to an offset of 0, resulting in no change either way.  When the player is on the top though, the board the player sees is flipped 180 degrees (rotate(7)), and the player's move is raised by 7 to place it on the proper side of the board.</p>
			<p>This class also defines the helper method simulate(), which given a board and a move, will return the resulting board.  This makes searching a lot easier for the subclasses.</p>
			<p>The above code makes use of a rotate() method we haven't seen.  It comes from a few helpers added to Array:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment">#Some helpers in Array</span><br />    <span class="keyword">class</span> Array<br />        <span class="keyword">def</span> rotate n<br />            a =dup<br />            n.times <span class="keyword">do</span> a &lt;&lt; a.shift <span class="keyword">end</span><br />            a<br />        <span class="keyword">end</span><br />        <span class="keyword">def</span> sum<br />            inject(0){|s,e|s+=e}<br />        <span class="keyword">end</span><br />        <span class="comment">#choose randomly between all items with given value</span><br />        <span class="keyword">def</span> random_index value<br />            n=rand(find_all{|e|e==value}.size)<br />            each_with_index{|e,i| <span class="keyword">return</span> i <span class="keyword">if</span> e==value <span class="keyword">and</span> (n-=1)&lt;0 }<br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>The first method is the rotate() call used earlier.  It's pretty simple, just returning a copy of the Array with the elements cycled in a circular fashion the requested number of times.</p>
			<p>I really hope sum() needs no introduction by this point, as it's probably the most popular helper method in Ruby Quiz solutions.  It just returns a summation of all elements in the Array.</p>
			<p>Finally, random_index() selects a random element equal to the passed in value.  In other words, if an Array contained [1, 2, 3, 2] and you call random_index(2), you have a 50/50 chance of getting 1 or 3 (the indices of the 2s) returned.</p>
			<p>Now we're ready to actually build a player:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment">#Tries to find the biggest increase in score for a turn</span><br />    <span class="keyword">class</span> DeepScoreKalahPlayer &lt; KalahPlayer<br />        <span class="keyword">def</span> get_move<br />            best_move(<span class="variable">@board</span>)<br />        <span class="keyword">end</span><br />        <span class="keyword">def</span> best_move board<br />            possible_scores = (0..5).map{|i| score_for(board,i)}<br />            possible_scores.index(possible_scores.max)<br />        <span class="keyword">end</span><br /><br />        <span class="comment">#find the increase in score if we make move m</span><br />        <span class="keyword">def</span> score_for board,m<br />            <span class="keyword">return</span> -100 <span class="keyword">if</span> board[m]&lt;1         <span class="comment">#flag invalid move</span><br />          b, taketurn  = board,<span class="keyword">true</span><br />            <span class="keyword">while</span> taketurn<br />                taketurn =  ((b[m]+m)%14 == 6)  <span class="comment">#will we land in kalah?</span><br />                b = simulate b,m<br />                m = best_move(b) <span class="keyword">if</span> taketurn<br />            <span class="keyword">end</span><br />            b[6]-board[6]                     <span class="comment">#how many points did we gain?</span><br />        <span class="keyword">end</span><br /><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>This is a fairly uncomplicated player with the idea of find the most points I can get with my move.  Remember, get_move() is the adapted interface, so that's where we start.  All it does is call best_move() passing in the current board.</p>
			<p>Now best_move() walks all possible moves calculating how many points we would earn by making the move.  When it has that information, it selects the highest point move and returns to index for that slot.</p>
			<p>The last piece of this puzzle is score_for().  Given a board and a move, it returns how many points you would gain by making the move.  This is slightly complicated, because a move ending in the Kalah allows us to move again.  That is handled with recursion by simply calling best_move() again on the new board.  When that's all done, subtracting the Kalah we started with from the Kalah we ended with gives us the points gained by the move or moves.</p>
			<p>Adam doesn't quit there though, there's another player that inherits from this one.  Let's take a look:</p>
			<div class="code"><span class="type">ruby</span><div class="body">    <span class="comment">#Tries to find the biggest increase in score for a turn</span><br />    <span class="comment">#subtracts opponent's possible score</span><br />    <span class="keyword">class</span> APessimisticKalahPlayer &lt; DeepScoreKalahPlayer<br />        MaxDepth = 3<br />        <span class="keyword">def</span> get_move<br />          <span class="variable">@level</span>=0<br />            best_move(<span class="variable">@board</span>)<br />        <span class="keyword">end</span><br />        <span class="keyword">def</span> best_move board<br />            <span class="keyword">return</span> <span class="keyword">super</span>(board) <span class="keyword">if</span> (<span class="variable">@level</span> &gt; MaxDepth)<br />            <span class="variable">@level</span>+=1<br />            possible_scores = (0..5).map{|i|<br />                score_for(board,i) - worst_case(simulate(board,i))<br />            }<br />            <span class="variable">@level</span>-=1<br />            possible_scores.random_index(possible_scores.max)<br />        <span class="keyword">end</span><br />        <span class="comment">#biggest score the opponent can get on this board</span><br />        <span class="keyword">def</span> worst_case board<br />            worst = 0<br />            opp_board = board.rotate 7<br />            6.times {|i|<br />                    s = score_for(opp_board, i)<br />                    worst = s <span class="keyword">if</span> worst &lt; s<br />                }<br />                worst<br />        <span class="keyword">end</span><br />    <span class="keyword">end</span><br /><br /></div></div>
			<p>This is a famous gaming algorithm known as a Minimax Search.  The idea is that everyone is always going to make their best move, both you and your opponent.  Given that, we want to find your best (or maximum) choice, but we also need to consider the opponent's best response.  We want to chose the path that minimizes the opponent's potential to get back at us.  The father ahead we can look in this fashion, the more intelligent of a decision we can make.</p>
			<p>The code above is very similar to the last player we examined.  The main new element here is worst_case(), which is just a tool to find the opponent's best move (worst for us).  Beyond that, you can see that get_move() and best_move() have been reworked to search down to a constant depth.  In this case, a depth of 3 was chosen.  Of course we want to look as deep as possible, but memory and execution time can make deeper searches unrealistic.</p>
			<p>Note that best_move() now subtracts worst_case() from score_for(), so the opponent's response move is weighted against our own.  This may even yield negative values for moves, because the opponent has a response better than the move we made.</p>
			<p>If you want to take Minimax deeper, you have to cut down the work it has to do.  A common technique is Alpha-Beta Pruning, which allows you to skip large portions of the move tree in your search.  I'm not going to show the code here, but be sure to look at David Balmain's code which walks father along this path.</p>
			<p>My thanks to all the players who always share such interesting solutions with us.</p>
			<p>Tomorrow I have a real treat for all you Ruby Quiz fans, our first prize awarding competition...</p>
		</div>
		<div id="logo"><img src="/web/20120121185421im_/http://rubyquiz.com/images/ruby_quiz_logo.jpg" alt="" width="157" height="150" /></div>
		<div id="links">
			<span class="title">Quiz Solutions</span>
			<ol>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/170196">David Balmain</a></li>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/170216">Rob Leslie</a></li>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/170317">Adam Shelly</a></li>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/170347">Adam Shelly (2)</a></li>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/170612">Adam Shelly (3)</a></li>
				<li><a href="/web/20120121185421/http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/171030">horndude77</a></li>
			</ol>
			<p><a href="/web/20120121185421/http://rubyquiz.com/quiz58_sols.zip">Download Solutions</a></p>
			<p><a href="/web/20120121185421/http://rubyquiz.com/index.html">Back to Quiz Listing</a></p>
		</div>
		<div id="footer">&nbsp;</div>
	</div>
</body>
</html>





<!--
     FILE ARCHIVED ON 18:54:21 Jan 21, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:09:52 Jun 5, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
